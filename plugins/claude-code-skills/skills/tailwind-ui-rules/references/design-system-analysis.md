# Design System Analysis Procedure

This reference describes how to scan an existing project for TailwindCSS patterns and generate a persistent `design-system.md` file.

**When to use this file:** Only when Section 0 of the SKILL.md detects `NO_DESIGN_SYSTEM_FILE` (first activation in a project) or when the user requests a design system refresh.

---

## Scanning Rules

- **Keep it fast.** The analysis must not block the user's actual task. Target: 6-10 tool calls total.
- **Pattern detection, not exhaustive listing.** Use `head_limit: 50` on Grep calls. You need the most common patterns, not every occurrence.
- **Scan template files only.** Target: `**/*.{html,jsx,tsx,vue,svelte,astro}` and `tailwind.config.*`
- **If the project has no TailwindCSS files yet**, skip scanning and generate a minimal design system file with "New project" defaults.

---

## Scanning Steps

### Step 1: Tailwind Configuration

Glob for `tailwind.config.*` (js, ts, mjs, cjs). If found, Read the file and extract:

| Look for | What it tells you |
|----------|-------------------|
| `darkMode` | Strategy: `'class'`, `'media'`, or `'selector'` |
| `theme.extend.colors` | Custom color palette |
| `theme.extend.fontFamily` | Custom fonts |
| `theme.extend.spacing` | Custom spacing values |
| `theme.extend.borderRadius` | Custom radius tokens |
| `plugins` | Active plugins (forms, typography, container-queries, etc.) |

If no config file exists, note "Default Tailwind configuration" in the design system.

### Step 2: Shadow Patterns

```
Grep pattern: shadow-(sm|md|lg|xl|2xl|none)
Glob filter: *.{html,jsx,tsx,vue,svelte,astro}
head_limit: 50
```

Analyze results to determine:
- Which shadow levels are actively used
- Whether `dark:shadow-` variants exist
- Any colored shadows (`shadow-blue-500/25` etc.)
- The most common default card shadow

### Step 3: Color Palette

```
Grep pattern: (bg|text|border)-(slate|gray|zinc|neutral|stone|red|orange|amber|yellow|lime|green|emerald|teal|cyan|sky|blue|indigo|violet|purple|fuchsia|pink|rose)-\d
Glob filter: *.{html,jsx,tsx,vue,svelte,astro}
head_limit: 50
```

Analyze results to identify:
- **Primary color family**: The most-used non-gray color (e.g., blue, indigo)
- **Neutral scale**: Which gray variant (gray, slate, zinc, neutral, stone)
- **Accent colors**: Secondary colors used for highlights, success states, etc.
- **Dark mode text/bg**: Whether `dark:` variants are used and which colors

### Step 4: Spacing Patterns

```
Grep pattern: (p|px|py|pl|pr|pt|pb|m|mx|my|gap)-(\[|[0-9])
Glob filter: *.{html,jsx,tsx,vue,svelte,astro}
head_limit: 50
```

Analyze results to determine:
- Most common padding values (e.g., `p-4`, `p-6`)
- Most common gap values (e.g., `gap-4`, `gap-6`)
- Whether arbitrary values like `p-[13px]` are used (flag as technical debt)
- Section spacing rhythm (e.g., `py-12`, `py-16`, `py-24`)

### Step 5: Layout & Component Patterns

```
Grep pattern: (rounded|max-w|grid-cols|transition|duration)-
Glob filter: *.{html,jsx,tsx,vue,svelte,astro}
head_limit: 50
```

Analyze results to determine:
- **Border radius convention**: `rounded-md`, `rounded-lg`, `rounded-xl`, etc.
- **Container width**: `max-w-7xl`, `max-w-6xl`, etc.
- **Grid patterns**: Common `grid-cols-*` progressions
- **Transition timing**: Most common `duration-*` value
- **Layout approach**: Predominantly grid-based or flex-based

### Step 6: Typography & Interactive States

```
Grep pattern: (text-(xs|sm|base|lg|xl|2xl|3xl|4xl)|font-(thin|light|normal|medium|semibold|bold)|focus-visible:|focus:ring)
Glob filter: *.{html,jsx,tsx,vue,svelte,astro}
head_limit: 50
```

Analyze results to determine:
- Heading size range (e.g., `text-xl` to `text-3xl`)
- Body text size (e.g., `text-base` or `text-sm`)
- Font weight pattern (e.g., `font-semibold` for headings, `font-normal` for body)
- Focus approach: `focus-visible:` (correct) vs `focus:` (outdated)
- Ring color used for focus states

---

## Output: `design-system.md` Template

Write this file to the **project root** directory. Fill in the `{placeholders}` with findings from the scan. If a value was not detected, use the skill's default recommendation and mark it with `(default)`.

```markdown
# Project Design System

<!-- Auto-generated by tailwind-ui-rules skill. Last updated: {YYYY-MM-DD} -->
<!-- To refresh: ask Claude to "re-analyze design patterns" -->

## Colors

| Role | Light | Dark |
|------|-------|------|
| Primary | {e.g., blue-600} | {e.g., blue-500} |
| Neutral | {e.g., gray} | {e.g., gray} |
| Accent | {e.g., emerald-500} | {e.g., emerald-400} |
| Destructive | {e.g., red-600} | {e.g., red-500} |

## Shadows

| Level | Class | Usage |
|-------|-------|-------|
| Default | {e.g., shadow-sm} | Cards at rest |
| Hover | {e.g., shadow-md} | Hovered cards, dropdowns |
| Floating | {e.g., shadow-xl} | Modals, overlays |

Dark mode approach: {e.g., reduced shadows with dark:shadow-black/20 / borders instead of shadows}

## Spacing

- Component padding: {e.g., p-4 to p-6}
- Component gap: {e.g., gap-4}
- Section gap: {e.g., gap-6 to gap-8}
- Section rhythm: {e.g., py-12 sm:py-16 lg:py-24}
- Arbitrary values: {none found / list offenders}

## Typography

- Headings: {e.g., font-semibold, text-xl to text-3xl}
- Body: {e.g., text-base text-gray-600 dark:text-gray-400}
- Small/caption: {e.g., text-sm text-gray-500}
- Font family: {e.g., default sans / Inter / custom}

## Layout

- Container: {e.g., mx-auto max-w-7xl px-4 sm:px-6 lg:px-8}
- Primary layout: {e.g., CSS Grid with flexbox for 1D}
- Card grid: {e.g., grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6}
- Sidebar layout: {e.g., grid grid-cols-[280px_1fr] / not used}

## Border Radius

- Cards/panels: {e.g., rounded-lg}
- Buttons: {e.g., rounded-md}
- Inputs: {e.g., rounded-md}
- Badges/chips: {e.g., rounded-full}

## Interactive States

- Focus: {e.g., focus-visible:ring-2 ring-blue-500 ring-offset-2}
- Transitions: {e.g., transition-colors duration-150 for micro, duration-300 for major}
- Card hover: {e.g., hover:shadow-md hover:-translate-y-0.5}
- Disabled: {e.g., disabled:opacity-50 disabled:cursor-not-allowed}

## Dark Mode

- Strategy: {class / media / not configured}
- Surface layers: {e.g., bg-gray-950 (base) / bg-gray-900 (surface) / bg-gray-800 (elevated)}
- Text primary: {e.g., text-gray-100}
- Text secondary: {e.g., text-gray-400}
- Borders: {e.g., border-gray-700}

## Tailwind Config

- Plugins: {e.g., @tailwindcss/forms, @tailwindcss/typography / none}
- Custom tokens: {e.g., custom colors defined / using defaults}
- Content paths: {e.g., ./src/**/*.{ts,tsx}}

## Notes

{Any project-specific observations, e.g.:
- "Uses Headless UI for all interactive components"
- "Has custom animate-* utilities for page transitions"
- "No dark mode support yet — consider adding"
- "Mixed shadow usage detected — recommend standardizing on shadow-sm default"}
```

---

## Handling Edge Cases

### New Project (No TailwindCSS Files)

Generate a minimal design system file:

```markdown
# Project Design System

<!-- Auto-generated by tailwind-ui-rules skill. Last updated: {YYYY-MM-DD} -->
<!-- To refresh: ask Claude to "re-analyze design patterns" -->

## Status

New project — no existing TailwindCSS patterns detected. Using skill defaults.
All values below are recommendations that will be applied to new components.

## Colors

| Role | Light | Dark |
|------|-------|------|
| Primary | blue-600 | blue-500 |
| Neutral | gray | gray |

(Remaining sections use skill defaults from SKILL.md)
```

### Inconsistent Patterns

When the scan reveals conflicting patterns (e.g., both `shadow-sm` and `shadow-lg` used as default card shadow):
- Pick the **most frequently used** pattern
- Add a note in the `## Notes` section: "Mixed shadow usage detected (shadow-sm: 12 occurrences, shadow-lg: 8 occurrences) — standardizing on shadow-sm"
- This helps the user notice and clean up inconsistencies

### Monorepo / Multi-Package

The `design-system.md` is created in the current working directory (where Claude Code was launched). In a monorepo, this is typically the workspace root. If the user needs per-package design systems, they should launch Claude Code from within the specific package directory.

### Very Large Projects

If Grep returns the maximum `head_limit` results for every pattern, the project is large. In this case:
- Focus on the `src/` or `app/` directory if it exists (narrow the Glob path)
- Note in the design system: "Large project — analysis based on sampled results from {directory}"
